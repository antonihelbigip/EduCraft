<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EduCraft ‚Äì Minecraft OZE</title>
  <link rel="stylesheet" href="style.css">
  <meta name="description" content="EduCraft ‚Äì educational Minecraft server powered by renewable energy.">

  <!-- Favicon -->
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="favicon.png">

  <!-- Open Graph (zastƒÖp URL/obrazki w≈Çasnymi kiedy bƒôdziesz mia≈Ç domenƒô) -->
  <meta property="og:title" content="EduCraft ‚Äì Minecraft OZE" />
  <meta property="og:description" content="Pierwszy w Polsce edukacyjny serwer Minecraft zasilany w 100% energiƒÖ odnawialnƒÖ." />
  <meta property="og:image" content="https://twoja-domena.pl/tlo.jpg" />
  <meta property="og:url" content="https://twoja-domena.pl/" />
  <meta property="og:type" content="website" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="EduCraft ‚Äì Minecraft OZE" />
  <meta name="twitter:description" content="Minecraft + OZE + edukacja. Do≈ÇƒÖcz!" />
  <meta name="twitter:image" content="https://twoja-domena.pl/tlo.jpg" />

  <!-- marked.js (render markdown w przeglƒÖdarce) -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <!-- TOPBAR ‚Äî full-width wrapper + centered container -->
  <div class="topbar" role="navigation" aria-label="G≈Ç√≥wna nawigacja">
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:12px;padding:0.5rem 0;">
      <div style="display:flex;align-items:center;gap:12px;">
        <a class="brand" href="#home" aria-label="EduCraft">EduCraft</a>

        <!-- mobile toggle (widoczny na ma≈Çych ekranach) -->
        <button class="nav-toggle" aria-expanded="false" aria-label="Otw√≥rz menu">
          <span></span><span></span><span></span>
        </button>

        <nav class="main-nav" role="navigation" aria-label="G≈Ç√≥wna nawigacja">
          <ul>
            <li><a href="#about" data-i18n="nav_about">O projekcie</a></li>
            <li><a href="#education" data-i18n="nav_education">Edukacja</a></li>
            <li><a href="#publications" data-i18n="nav_publications">Publikacje</a></li>
            <li><a href="#projects" data-i18n="nav_projects">Projekty</a></li>
            <li><a href="#multimedia" data-i18n="nav_multimedia">Multimedia</a></li>
            <li><a href="#blog" data-i18n="nav_blog">Blog</a></li>
            <li><a href="#contact" data-i18n="nav_contact">Kontakt</a></li>
          </ul>
        </nav>
      </div>

      <div class="right-group" style="display:flex;align-items:center;gap:.6rem;">
        <div class="lang-switch" aria-hidden="false">
          <button class="lang-btn" data-lang="pl" title="Polski">PL</button>
          <button class="lang-btn" data-lang="en" title="English">EN</button>
          <button class="lang-btn" data-lang="de" title="Deutsch">DE</button>
        </div>
        <a id="cta-support" class="btn btn-primary" href="https://zrzutka.pl/b5j6vm" target="_blank" rel="noopener" data-i18n="cta_support">Wesprzyj</a>
      </div>
    </div>
  </div>

 <!-- HERO (tylko t≈Ço) -->
<header class="hero" id="home" role="banner" aria-label="Hero">
  <div class="hero-inner container">
    <!-- puste (chcia≈Çe≈õ bez tekst√≥w/przycisk√≥w) -->
  </div>
</header>

  <main class="container" role="main" style="padding-top:18px;">
    <!-- About -->
    <section id="about" class="card" aria-labelledby="about-heading">
      <h2 id="about-heading" data-i18n="about_title">O projekcie</h2>
      <p data-i18n="about_text">
        Budujƒô otwarto-edukacyjny serwer Minecraft, kt√≥ry dzia≈Ça 24/7 dziƒôki energii z paneli s≈Çonecznych i turbiny wiatrowej.
        To po≈ÇƒÖczenie gier, technologii i ekologii ‚Äî gracz zobaczy w praktyce, jak dzia≈Ça system OZE.
      </p>
    </section>

    <!-- Education -->
    <section id="education" class="card muted" aria-labelledby="education-heading">
      <h3 id="education-heading" data-i18n="education_title">Edukacja</h3>
      <p data-i18n="education_text">Materia≈Çy edukacyjne i scenariusze lekcji: energia s≈Çoneczna, wiatr, magazynowanie, monitoring i automatyka (Home Assistant).</p>
      <ul>
        <li>Lesson: Solar Basics</li>
        <li>Lesson: Wind Energy</li>
        <li>Lesson: Monitoring & Home Assistant</li>
      </ul>
    </section>

    <!-- Publications (tabela) -->
    <section id="publications" class="card" aria-labelledby="publications-heading">
      <h3 id="publications-heading" data-i18n="publications_title">Publikacje</h3>
      <p data-i18n="publications_intro">Lista raport√≥w, artyku≈Ç√≥w i materia≈Ç√≥w edukacyjnych zwiƒÖzanych z projektem.</p>
      <div class="table-wrap" style="overflow:auto;margin-top:1rem;">
        <table class="pub-table" style="width:100%;border-collapse:collapse;">
          <thead>
            <tr>
              <th style="text-align:left;padding:.6rem;border-bottom:1px solid #eee">Rok</th>
              <th style="text-align:left;padding:.6rem;border-bottom:1px solid #eee">Tytu≈Ç</th>
              <th style="text-align:left;padding:.6rem;border-bottom:1px solid #eee">Typ</th>
              <th style="text-align:left;padding:.6rem;border-bottom:1px solid #eee">Link</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding:.6rem;border-bottom:1px solid #f1f1f1">2025</td>
              <td style="padding:.6rem;border-bottom:1px solid #f1f1f1">EduCraft ‚Äî raport wdro≈ºenia OZE</td>
              <td style="padding:.6rem;border-bottom:1px solid #f1f1f1">Raport</td>
              <td style="padding:.6rem;border-bottom:1px solid #f1f1f1"><a href="https://github.com/antonihelbigip/EduCraft" target="_blank" rel="noopener">GitHub</a></td>
            </tr>
            <tr>
              <td style="padding:.6rem;border-bottom:1px solid #f1f1f1">2024</td>
              <td style="padding:.6rem;border-bottom:1px solid #f1f1f1">Scenariusze lekcji: Energia w praktyce</td>
              <td style="padding:.6rem;border-bottom:1px solid #f1f1f1">Materia≈Çy</td>
              <td style="padding:.6rem;border-bottom:1px solid #f1f1f1"><a href="#" onclick="alert('Podmie≈Ñ link do PDF');return false;">PDF</a></td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Creator -->
    <section id="creator" class="card muted" aria-labelledby="creator-heading">
      <h3 id="creator-heading" data-i18n="creator_title">Kim jestem?</h3>
      <p data-i18n="creator_text">Nazywam siƒô Antoni ‚Äî student mechatroniki, sta≈ºysta AI w Siemens, trzykrotny laureat konkursu ‚ÄûM√≥j pomys≈Ç na biznes‚Äù.</p>
    </section>

    <!-- What we build -->
    <section id="build" class="card" aria-labelledby="build-heading">
      <h3 id="build-heading" data-i18n="build_title">Co budujƒô?</h3>
      <ul>
        <li data-i18n="build_li1">Serwer 24/7 zasilany panelami PV i turbinƒÖ wiatrowƒÖ</li>
        <li data-i18n="build_li2">Platforma edukacyjna z zadaniami, NPC/AI i mapƒÖ EarthMC</li>
        <li data-i18n="build_li3">System monitoringu energii (Raspberry Pi + Home Assistant)</li>
      </ul>
    </section>

    <!-- Projects -->
    <section id="projects" class="card muted" aria-labelledby="projects-heading">
      <h3 id="projects-heading" data-i18n="projects_title">Projekty</h3>
      <ul>
        <li>SunBlock One ‚Äî solar powered modded server (inspiracja)</li>
        <li>Gaia‚Äôs Riddle ‚Äî edukacyjne scenariusze</li>
        <li>Fun Palace SMP ‚Äî wydarzenia i warsztaty</li>
      </ul>
    </section>

    <!-- Progress / dynamic updates (Pobierane z _posts w repo) -->
    <section id="updates-frame" class="card muted" aria-labelledby="updates-heading">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
        <h3 id="updates-heading" data-i18n="updates_title">üîî Aktualizacje projektu</h3>
        <div style="display:flex;gap:8px;align-items:center;">
          <button id="refresh-posts" class="btn btn-outline" title="Od≈õwie≈º aktualizacje">Od≈õwie≈º</button>
          <a id="open-zrzutka" class="btn btn-outline" href="https://zrzutka.pl/zbudujmy-1-w-polsce-edukacyjny-eco-serwer-minecraft-z-oze-b5j6vm#updates" target="_blank" rel="noopener">Zrzutka ‚Äî pe≈Çne</a>
        </div>
      </div>

      <div id="updates-controls" style="margin-top:10px;display:flex;align-items:center;gap:12px;">
        <div class="small">Filtr jƒôzyka aktualizacji:</div>
        <div style="display:flex;gap:8px;">
          <button class="filter-btn btn btn-outline" data-filter="pl">PL</button>
          <button class="filter-btn btn btn-outline" data-filter="en">EN</button>
          <button class="filter-btn btn btn-outline" data-filter="de">DE</button>
        </div>
      </div>

      <div id="updates-list" style="margin-top:12px;max-height:520px;overflow:auto;padding:6px;border-radius:8px;background:var(--muted);">
        <p class="small">≈Åadowanie aktualizacji‚Ä¶</p>
      </div>

      <div style="margin-top:10px;display:flex;justify-content:center;">
        <button id="load-more" class="btn btn-outline" style="display:none;">Poka≈º wiƒôcej</button>
      </div>
    </section>

    <!-- Multimedia -->
    <section id="multimedia" class="card gallery" aria-labelledby="gallery-heading">
      <h3 id="gallery-heading" data-i18n="gallery_title">Galeria / Multimedia</h3>
      <div class="carousel">
        <div class="carousel-track"></div>
      </div>
      <div class="carousel-controls" aria-hidden="false">
        <input type="range" class="carousel-range" min="0" value="0" step="1" />
      </div>
    </section>

    <!-- FAQ -->
    <section id="faq" class="card muted" aria-labelledby="faq-heading">
      <h3 id="faq-heading" data-i18n="faq_title">Najczƒôstsze pytania (FAQ)</h3>
      <!-- dynamic FAQ (skrypt dopisze tre≈õci) -->
    </section>

    <!-- Support -->
    <section id="support" class="card support" aria-labelledby="support-heading">
      <h3 id="support-heading" data-i18n="support_title">Wesprzyj projekt</h3>
      <p data-i18n="support_text">Wesprzyj nas na Zrzutka.pl ‚Äî ka≈ºda z≈Çot√≥wka przybli≈ºa testy zasilania z OZE i rozw√≥j tre≈õci edukacyjnych.</p>
      <div class="widget-wrap">
        <div style="position: relative; width: 100%; height: 480px; overflow: hidden;">
          <iframe style="position: absolute; top:0; left: 0; bottom: 0; right: 0; width: 100%; height: 100%;"
            src="https://zrzutka.pl/b5j6vm/widget/13" frameborder="0" scrolling="no" title="Zrzutka widget"></iframe>
        </div>
      </div>
    </section>

    <!-- Contact -->
    <section id="contact" class="card" aria-labelledby="contact-heading">
      <h3 id="contact-heading" data-i18n="contact_title">Kontakt & spo≈Çeczno≈õƒá</h3>
      <p data-i18n="contact_text">Discord (wkr√≥tce) ‚Ä¢ GitHub: <a href="https://github.com/antonihelbigip/EduCraft" target="_blank" rel="noopener">github.com/antonihelbigip/EduCraft</a></p>
    </section>
  </main>

  <footer class="site-footer" role="contentinfo">
    <div class="container">
      <small data-i18n="footer_text">¬© 2025 EduCraft ‚Ä¢ MIT License ‚Ä¢ Made by Antoni</small>
    </div>
  </footer>

  <!-- NAV TOGGLE + accessibility helpers -->
  <script>
    (function(){
      const btn = document.querySelector('.nav-toggle');
      const nav = document.querySelector('.main-nav');
      if(!btn || !nav) return;
      btn.addEventListener('click', ()=> {
        const open = nav.classList.toggle('open');
        btn.setAttribute('aria-expanded', open ? 'true' : 'false');
      });
      // close mobile nav on resize > 760
      window.addEventListener('resize', ()=> {
        if(window.innerWidth > 760 && nav.classList.contains('open')) {
          nav.classList.remove('open');
          btn.setAttribute('aria-expanded','false');
        }
      });
      // close on link click (mobile)
      nav.querySelectorAll('a[href^="#"]').forEach(a=>{
        a.addEventListener('click', ()=> { if(nav.classList.contains('open')) { nav.classList.remove('open'); btn.setAttribute('aria-expanded','false'); }});
      });
    })();
  </script>

  <!-- Gallery + Language Script (gallery uses GitHub raw content) -->
  <script>
  (async function(){
    const owner = 'antonihelbigip';
    const repo = 'EduCraft';
    const path = 'images';
    const branch = 'main';
    const gallery = document.querySelector('.gallery');
    if (!gallery) return;
    const track = gallery.querySelector('.carousel-track');
    const range = gallery.querySelector('.carousel-range');
    if (!track || !range) return;
    track.innerHTML = '<p class="small">≈Åadowanie galerii‚Ä¶</p>';
    const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${path}?ref=${branch}`;
    try {
      const res = await fetch(apiUrl);
      if (!res.ok) throw new Error('GitHub API error: ' + res.status);
      const files = await res.json();
      const imgs = Array.isArray(files) ? files.filter(f => /\.(jpe?g|png|gif|webp|svg)$/i.test(f.name)) : [];
      if (imgs.length === 0) { track.innerHTML = '<p class="small">Brak obraz√≥w w katalogu images/. Dodaj pliki i zr√≥b push.</p>'; range.style.display='none'; return; }
      imgs.sort((a,b)=>a.name.localeCompare(b.name, undefined, {numeric:true}));
      track.innerHTML='';
      const slides = [];
      const rawUrl = (p, filename)=>`https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${p? p+'/' : ''}${encodeURIComponent(filename)}`;
      imgs.forEach(file=>{
        const slide=document.createElement('div');
        slide.className='carousel-slide';
        const img=document.createElement('img');
        img.src=rawUrl(path,file.name);
        img.setAttribute('data-i18n-alt',file.name.replace(/\.[^/.]+$/,'').replace(/[-_]/g,'_'));
        img.loading='lazy';
        slide.appendChild(img);
        track.appendChild(slide);
        slides.push(slide);
      });

      let visible = window.innerWidth <= 760 ? 1 : 2;
      let currentIndex = 0;
      const total = slides.length;
      let maxIndex = Math.max(0,total-visible);
      const rangeUpdate = ()=>{ visible = window.innerWidth<=760?1:2; maxIndex=Math.max(0,total-visible); range.max=maxIndex; if(+range.value>maxIndex) range.value=maxIndex; updatePosition(+range.value);}
      const updatePosition = index=>{currentIndex=index; track.style.transform=`translateX(-${index*(100/visible)}%)`; range.value=index;}
      const setSlideBasis=()=>{const basis=100/visible; slides.forEach(s=>{s.style.flex=`0 0 ${basis}%`; s.style.height=`${s.offsetWidth*0.6}px`}); updatePosition(Math.min(currentIndex,Math.max(0,total-visible)));}
      rangeUpdate(); setSlideBasis();
      let resizeTimer;
      window.addEventListener('resize',()=>{clearTimeout(resizeTimer); resizeTimer=setTimeout(()=>{rangeUpdate(); setSlideBasis();},120);});
      range.addEventListener('input', e=>updatePosition(+e.target.value));

      let autoplayInterval=2500, autoplayTimer=null;
      const startAutoplay=()=>{stopAutoplay(); if(total<=visible)return; autoplayTimer=setInterval(()=>{let next=currentIndex+1;if(next>maxIndex)next=0;updatePosition(next);},autoplayInterval);}
      const stopAutoplay=()=>{if(autoplayTimer){clearInterval(autoplayTimer); autoplayTimer=null;}}
      gallery.addEventListener('mouseenter',stopAutoplay);
      gallery.addEventListener('mouseleave',startAutoplay);
      if(total<=visible){range.style.display='none'; track.style.justifyContent='center'; slides.forEach(slide=>slide.style.flex=`0 0 ${100/total}%`);}else range.style.display='block';
      startAutoplay();

      // ALT translations (empty; left for future i18n)
      const TRANSLATIONS_ALT={pl:{},en:{},de:{}};
      const applyAltLanguage=lang=>{slides.forEach(s=>{const img=s.querySelector('img[data-i18n-alt]'); const key=img.getAttribute('data-i18n-alt'); img.alt=(TRANSLATIONS_ALT[lang]&&TRANSLATIONS_ALT[lang][key])?TRANSLATIONS_ALT[lang][key]:key;});}
      const initLang=localStorage.getItem('educraft_lang')||'pl';
      applyAltLanguage(initLang);
      document.querySelectorAll('.lang-btn').forEach(btn=>{btn.addEventListener('click',()=>applyAltLanguage(btn.dataset.lang));});
    } catch(err){console.error(err); track.innerHTML='<p class="small">Nie uda≈Ço siƒô za≈Çadowaƒá galerii. Sprawd≈∫ konsolƒô (F12).</p>'; range.style.display='none';}
  })();
  </script>

  <!-- TRANSLATIONS & SWITCHER SCRIPT + dynamic updates loader -->
  <script>
  const TRANSLATIONS = {
    pl: {
      nav_about: "O projekcie",
      nav_education: "Edukacja",
      nav_publications: "Publikacje",
      nav_projects: "Projekty",
      nav_multimedia: "Multimedia",
      nav_blog: "Blog",
      nav_contact: "Kontakt",
      hero_title: "EduCraft",
      hero_lead: "Pierwszy w Polsce edukacyjny serwer Minecraft zasilany w 100% energiƒÖ odnawialnƒÖ.",
      cta_support: "Wesprzyj",
      cta_about: "Dowiedz siƒô wiƒôcej",
      about_title: "O projekcie",
      about_text: "Budujƒô otwarto-edukacyjny serwer Minecraft, kt√≥ry dzia≈Ça 24/7 dziƒôki energii z paneli s≈Çonecznych i turbiny wiatrowej. To po≈ÇƒÖczenie gier, technologii i ekologii ‚Äî gracz zobaczy w praktyce, jak dzia≈Ça system OZE.",
      education_title: "Edukacja",
      education_text: "Program edukacyjny zawiera modu≈Çy: Energia s≈Çoneczna, Energia wiatrowa, Magazynowanie energii, Automatyka i Home Assistant.",
      publications_title: "Publikacje",
      publications_intro: "Lista raport√≥w, artyku≈Ç√≥w i materia≈Ç√≥w edukacyjnych zwiƒÖzanych z projektem.",
      creator_title: "Kim jestem?",
      creator_text: "Nazywam siƒô Antoni ‚Äî student mechatroniki, sta≈ºysta AI w Siemens, trzykrotny laureat konkursu ‚ÄûM√≥j pomys≈Ç na biznes‚Äù.",
      build_title: "Co budujƒô?",
      build_li1: "Serwer 24/7 zasilany panelami PV i turbinƒÖ wiatrowƒÖ",
      build_li2: "Platforma edukacyjna z zadaniami, NPC/AI i mapƒÖ EarthMC",
      build_li3: "System monitoringu energii (Raspberry Pi + Home Assistant)",
      projects_title: "Projekty",
      updates_title: "Aktualizacje",
      updates_li1: "2√ó HP EliteDesk (Ryzen 5, 32GB, SSD) ‚Äì serwery postawione",
      updates_li2: "Tryby: Proxy, Lobby, PvP, EarthMC",
      updates_li3: "Pluginy: EssentialsX, LuckPerms, Citizens, WorldEdit, WorldGuard, TAB, Dynmap",
      updates_li4: "Monitoring energii (miernik Teccus) ‚Äì plan integracji z Home Assistant",
      gallery_title: "Galeria / Multimedia",
      blog_title: "Blog",
      support_title: "Wesprzyj projekt",
      support_text: "Wesprzyj nas na Zrzutka.pl ‚Äî ka≈ºda z≈Çot√≥wka przybli≈ºa testy zasilania z OZE i rozw√≥j tre≈õci edukacyjnych.",
      faq_title: "Najczƒôstsze pytania (FAQ)",
      faq_q1: "Czy serwer bƒôdzie darmowy?",
      faq_a1: "Tak ‚Äî serwer bƒôdzie otwarty, bez whitelisty, bez kont premium. WspierajƒÖcy dostanƒÖ dodatkowe bonusy (role, skiny, tabliczki).",
      faq_q2: "Czy zasilanie OZE bƒôdzie realne?",
      faq_a2: "Tak ‚Äî panele PV, turbina wiatrowa i akumulatory LiFePO‚ÇÑ zapewniƒÖ 100% energii. Ca≈Ço≈õƒá zarzƒÖdzana przez Raspberry Pi i Home Assistant.",
      faq_q3: "Czy mam zgodƒô na odwzorowanie kampusu?",
      faq_a3: "Z≈Ço≈ºy≈Çem wniosek ‚Äî rozpocznƒô odwzorowywanie po jej uzyskaniu. Mam wstƒôpne poparcie uczelni.",
      faq_q4: "Czy mo≈ºna pom√≥c w budowie lub tre≈õciach?",
      faq_a4: "Tak ‚Äî planujƒô otwartƒÖ rekrutacjƒô edukator√≥w i budowniczych. WspierajƒÖcy otrzymajƒÖ wcze≈õniejszy dostƒôp przez Discorda.",
      faq_q5: "Co, je≈õli nie zbierzemy ca≈Çej kwoty?",
      faq_a5: "Ka≈ºdy etap ma okre≈õlone minimum. Zrealizujƒô tyle, ile siƒô uda ‚Äî zaczynajƒÖc od etapu 1: zasilania i podstawowego serwera.",
      faq_q6: "Jak ≈õledziƒá postƒôpy?",
      faq_a6: "Postƒôpy bƒôdƒÖ publikowane na stronie zrzutki, stronie projektu oraz Discordzie. Bƒôdzie publiczny pasek postƒôpu i wizualizacje.",
      faq_q7: "Czy to tylko zabawa?",
      faq_a7: "Nie! To edukacyjny projekt z misjƒÖ. Minecraft to ≈õwietna platforma do nauki o OZE, automatyce i fizyce w przystƒôpnej formie.",
      faq_q8: "Czy projekt bƒôdzie open-source?",
      faq_a8: "Tak ‚Äî dokumentacja techniczna, kod automatyki i czƒô≈õƒá materia≈Ç√≥w edukacyjnych bƒôdzie dostƒôpna na licencji open-source.",
      contact_title: "Kontakt & spo≈Çeczno≈õƒá",
      contact_text: "Discord (wkr√≥tce) ‚Ä¢ GitHub: github.com/antonihelbigip/EduCraft",
      footer_text: "¬© 2025 EduCraft ‚Ä¢ MIT License ‚Ä¢ Made by Antoni"
    },
    en: {
      nav_about: "About",
      nav_education: "Education",
      nav_publications: "Publications",
      nav_projects: "Projects",
      nav_multimedia: "Multimedia",
      nav_blog: "Blog",
      nav_contact: "Contact",
      hero_title: "EduCraft",
      hero_lead: "The first Polish educational Minecraft server powered 100% by renewable energy.",
      cta_support: "Support",
      cta_about: "Learn more",
      about_title: "About",
      about_text: "I'm building an open educational Minecraft server that runs 24/7 thanks to solar panels and a wind turbine. It combines gaming, technology and ecology ‚Äî players will see how renewable systems work in practice.",
      education_title: "Education",
      education_text: "Curriculum: Solar energy, Wind energy, Storage, Monitoring and Automation (Home Assistant).",
      publications_title: "Publications",
      publications_intro: "Reports, papers and educational materials related to the project.",
      creator_title: "About the creator",
      creator_text: "My name is Antoni ‚Äî mechatronics student, AI intern at Siemens, three-time winner of the 'My business idea' contest.",
      build_title: "What we build",
      build_li1: "24/7 server powered by PV panels and a wind turbine",
      build_li2: "Educational platform with quests, NPC/AI and EarthMC map",
      build_li3: "Energy monitoring system (Raspberry Pi + Home Assistant)",
      projects_title: "Projects",
      updates_title: "Updates",
      updates_li1: "2√ó HP EliteDesk (Ryzen 5, 32GB, SSD) ‚Äî servers deployed",
      updates_li2: "Modes: Proxy, Lobby, PvP, EarthMC",
      updates_li3: "Plugins: EssentialsX, LuckPerms, Citizens, WorldEdit, WorldGuard, TAB, Dynmap",
      updates_li4: "Energy metering (Teccus meter) ‚Äî plan to integrate with Home Assistant",
      gallery_title: "Gallery / Multimedia",
      blog_title: "Blog",
      support_title: "Support the project",
      support_text: "Support us on Zrzutka.pl ‚Äî every contribution helps powering tests and educational content.",
      faq_title: "FAQ",
      faq_q1: "Will the server be free?",
      faq_a1: "Yes ‚Äî the server will be open, without whitelist or premium accounts. Supporters will receive extra bonuses (roles, skins, signs).",
      faq_q2: "Is renewable energy supply feasible?",
      faq_a2: "Yes ‚Äî PV panels, a wind turbine, and LiFePO‚ÇÑ batteries will provide 100% energy. Everything is managed by Raspberry Pi and Home Assistant.",
      faq_q3: "Do I have permission to replicate the campus?",
      faq_a3: "I‚Äôve submitted a request ‚Äî I will start replication after approval. I have preliminary support from the university.",
      faq_q4: "Can I help with building or content?",
      faq_a4: "Yes ‚Äî I plan open recruitment for educators and builders. Supporters will get early access via Discord.",
      faq_q5: "What if we don‚Äôt raise the full amount?",
      faq_a5: "Each stage has a minimum. I will implement as much as possible ‚Äî starting from Stage 1: energy supply and basic server.",
      faq_q6: "How can I track progress?",
      faq_a6: "Progress will be published on the crowdfunding page, project website, and Discord. There will be a public progress bar and visualizations.",
      faq_q7: "Is this just for fun?",
      faq_a7: "No! This is an educational project with a mission. Minecraft is a great platform to learn about renewable energy, automation, and physics in a practical way.",
      faq_q8: "Will the project be open-source?",
      faq_a8: "Yes ‚Äî technical documentation, automation code, and some educational materials will be available under an open-source license.",
      contact_title: "Contact & community",
      contact_text: "Discord (coming soon) ‚Ä¢ GitHub: github.com/antonihelbigip/EduCraft",
      footer_text: "¬© 2025 EduCraft ‚Ä¢ MIT License ‚Ä¢ Made by Antoni"
    },
    de: {
      nav_about: "√úber das Projekt",
      nav_education: "Bildung",
      nav_publications: "Publikationen",
      nav_projects: "Projekte",
      nav_multimedia: "Multimedia",
      nav_blog: "Blog",
      nav_contact: "Kontakt",
      hero_title: "EduCraft",
      hero_lead: "Der erste polnische Bildungs-Minecraft-Server, der zu 100 % mit erneuerbarer Energie betrieben wird.",
      cta_support: "Unterst√ºtze",
      cta_about: "Mehr erfahren",
      about_title: "√úber das Projekt",
      about_text: "Ich baue einen offenen Bildungs-Minecraft-Server, der rund um die Uhr dank Solarpaneelen und einer Windturbine l√§uft.",
      education_title: "Bildung",
      education_text: "Curriculum und Lehrmaterialien (Solar, Wind, Monitoring).",
      publications_title: "Publikationen",
      publications_intro: "Berichte, Artikel und Bildungsressourcen zum Projekt.",
      creator_title: "√úber den Ersteller",
      creator_text: "Ich hei√üe Antoni ‚Äì Mechatronik-Student, AI-Praktikant bei Siemens.",
      build_title: "Was wir bauen",
      build_li1: "24/7 Server, betrieben durch PV-Module und Windturbine",
      build_li2: "Bildungsplattform mit Aufgaben, NPC/AI und EarthMC-Karte",
      build_li3: "Energiemonitoring-System (Raspberry Pi + Home Assistant)",
      projects_title: "Projekte",
      updates_title: "Aktualisierungen",
      updates_li1: "2√ó HP EliteDesk (Ryzen 5, 32GB, SSD) ‚Äî Server aufgesetzt",
      updates_li2: "Modi: Proxy, Lobby, PvP, EarthMC",
      updates_li3: "Plugins: EssentialsX, LuckPerms, Citizens, WorldEdit, WorldGuard, TAB, Dynmap",
      updates_li4: "Energie-Messung (Teccus) ‚Äî Integration mit Home Assistant geplant",
      gallery_title: "Galerie / Multimedia",
      blog_title: "Blog",
      support_title: "Unterst√ºtze das Projekt",
      support_text: "Unterst√ºtze nas na Zrzutka.pl ‚Äî ka≈ºdy wk≈Çad pomaga.",
      faq_title: "FAQ",
      faq_q1: "Wird der Server kostenlos sein?",
      faq_a1: "Ja ‚Äî der Server wird offen sein, ohne Whitelist oder Premium-Konten. Unterst√ºtzer erhalten zus√§tzliche Boni.",
      faq_q2: "Ist die Versorgung mit erneuerbarer Energie realistisch?",
      faq_a2: "Ja ‚Äî PV-Module, Windturbine und LiFePO‚ÇÑ-Akkus liefern Energie. Steuerung √ºber Raspberry Pi und Home Assistant.",
      faq_q3: "Habe ich die Genehmigung, den Campus nachzubilden?",
      faq_a3: "Antrag gestellt ‚Äî Nachbildung startet nach Genehmigung.",
      faq_q4: "Kann ich beim Bau helfen?",
      faq_a4: "Ja ‚Äî offene Rekrutierung geplant.",
      faq_q5: "Was passiert, wenn Ziel nicht erreicht wird?",
      faq_a5: "Realisierung etapami wed≈Çug dostƒôpnych ≈õrodk√≥w.",
      faq_q6: "Wie kann ich den Fortschritt verfolgen?",
      faq_a6: "Der Fortschritt wird auf der Crowdfunding-Seite, der Projektseite und Discord ver√∂ffentlicht.",
      faq_q7: "Ist das nur zum Spa√ü?",
      faq_a7: "Nein ‚Äî dies ist ein Bildungsprojekt mit einer Mission.",
      faq_q8: "Wird das Projekt Open-Source sein?",
      faq_a8: "Ja ‚Äî ein Teil der Materialien wird Open-Source sein.",
      contact_title: "Kontakt & Community",
      contact_text: "Discord (bald) ‚Ä¢ GitHub: github.com/antonihelbigip/EduCraft",
      footer_text: "¬© 2025 EduCraft ‚Ä¢ MIT License ‚Ä¢ Made by Antoni"
    }
  };

  // ---------------------------
  // Language switcher + i18n
  // ---------------------------
  function applyLanguage(lang){
    const dict = TRANSLATIONS[lang] || TRANSLATIONS['pl'];
    document.documentElement.lang = lang;
    document.querySelectorAll('[data-i18n]').forEach(el=>{
      const key = el.getAttribute('data-i18n');
      if(dict[key]) el.textContent = dict[key];
    });
    try{ localStorage.setItem('educraft_lang', lang); } catch(e){}
    document.querySelectorAll('.lang-btn').forEach(b=>b.classList.toggle('active', b.dataset.lang===lang));
    // also set filter-controls (buttons) active state
    document.querySelectorAll('.filter-btn').forEach(b=>b.classList.toggle('active', b.dataset.filter===lang));
    // load posts for this language
    loadPosts(lang);
  }

  (function initLang(){
    const urlParams = new URLSearchParams(window.location.search);
    let lang = urlParams.get('lang') || localStorage.getItem('educraft_lang') || (navigator.language||'pl').slice(0,2);
    if(!['pl','en','de'].includes(lang)) lang='pl';
    applyLanguage(lang);
  })();

  document.querySelectorAll('.lang-btn').forEach(btn=>{
    btn.addEventListener('click', ()=> applyLanguage(btn.dataset.lang));
  });

  // ---------------------------
  // Dynamic posts loader (from GitHub _posts)
  // ---------------------------
  const GH_OWNER = 'antonihelbigip';
  const GH_REPO  = 'EduCraft';
  const GH_REF   = 'main';
  const POSTS_PATH = '_posts';
  const POSTS_API = `https://api.github.com/repos/${GH_OWNER}/${GH_REPO}/contents/${POSTS_PATH}?ref=${GH_REF}`;
  const RAW_BASE = `https://raw.githubusercontent.com/${GH_OWNER}/${GH_REPO}/${GH_REF}/${POSTS_PATH}/`;

  let _postsCache = null;
  let _visibleCount = 5;

  async function fetchPostsList(){
    if(_postsCache) return _postsCache;
    try {
      const res = await fetch(POSTS_API);
      if(!res.ok) throw new Error('GitHub API: ' + res.status);
      const files = await res.json();
      const mdFiles = files.filter(f=>/\.md$/i.test(f.name));
      // load content of each file (in parallel, but limit friendly)
      const promises = mdFiles.map(f => fetch(RAW_BASE + encodeURIComponent(f.name)).then(r=>{
        if(!r.ok) throw new Error('Raw fetch error ' + r.status);
        return r.text().then(txt=>({name:f.name, text:txt}));
      }).catch(e=>{
        console.warn('Failed to fetch', f.name, e);
        return null;
      }));
      const results = (await Promise.all(promises)).filter(Boolean);
      const posts = results.map(r=>parseMarkdownPost(r.name, r.text)).filter(Boolean);
      // sort by date desc (if present)
      posts.sort((a,b)=> (new Date(b.date || 0)) - (new Date(a.date || 0)));
      _postsCache = posts;
      return posts;
    } catch(err){
      console.error('fetchPostsList', err);
      throw err;
    }
  }

  function parseMarkdownPost(filename, text){
    // extract YAML frontmatter
    const fmMatch = text.match(/^---\s*([\s\S]*?)\s*---\s*/);
    const fm = {};
    let body = text;
    if(fmMatch){
      const rawfm = fmMatch[1];
      body = text.slice(fmMatch[0].length);
      // very small YAML extractor (works for our simple frontmatter)
      rawfm.split('\n').forEach(line=>{
        const m = line.match(/^\s*([a-zA-Z0-9_-]+)\s*:\s*(.*)$/);
        if(m){
          const key = m[1].trim();
          let val = m[2].trim();
          // strip quotes
          if(/^".*"$/.test(val) || /^'.*'$/.test(val)) val = val.slice(1,-1);
          // arrays like images: - /path...
          if(val === '') {
            // multi-line possibly; handle images block
            if(/^\s*images\s*:\s*$/.test(line)){
              // collect following lines starting with -
              const imgs = [];
              const rest = rawfm.split('\n');
              const startIndex = rest.findIndex(l=>/^\s*images\s*:\s*$/.test(l));
              if(startIndex>=0){
                for(let i=startIndex+1;i<rest.length;i++){
                  const li = rest[i].match(/^\s*-\s*(.+)$/);
                  if(li) imgs.push(li[1].trim().replace(/^["']|["']$/g,'')); else break;
                }
              }
              fm['images'] = imgs;
            }
          } else {
            fm[key] = val;
          }
        }
      });
    }
    // basic required fields
    const titleMatch = (fm.title) ? fm.title : (body.match(/^#\s+(.+)$/m) ? body.match(/^#\s+(.+)$/m)[1].trim() : filename.replace(/^\d{4}-\d{2}-\d{2}-/,'').replace(/\.md$/,''));
    const date = fm.date || filename.slice(0,10);
    const lang = (fm.lang || 'pl').trim();
    const images = fm.images || [];
    // return object
    return {
      filename,
      title: titleMatch,
      date,
      lang,
      images,
      body
    };
  }

  function renderPostHTML(post){
    // create card html: title, date, excerpt (first paragraph) + read more toggle
    const html = [];
    html.push(`<article class="post-card" style="background:var(--card);padding:12px;border-radius:10px;margin-bottom:10px;box-shadow:0 6px 18px rgba(2,6,23,0.04);">`);
    html.push(`<header style="display:flex;justify-content:space-between;align-items:flex-start;gap:8px;margin-bottom:8px;">`);
    html.push(`<div><strong style="font-size:1.05rem;">${escapeHtml(post.title)}</strong><div class="small" style="margin-top:6px;color:#6b7280;">${new Date(post.date).toLocaleString(document.documentElement.lang || 'pl-PL', {year:'numeric',month:'short',day:'numeric'})}</div></div>`);
    html.push(`<div style="display:flex;gap:8px;align-items:center;"><a class="btn btn-outline" href="https://github.com/${GH_OWNER}/${GH_REPO}/blob/${GH_REF}/${POSTS_PATH}/${encodeURI(post.filename)}" target="_blank" rel="noopener">Surowy</a></div>`);
    html.push(`</header>`);
    if(post.images && post.images.length){
      const img = post.images[0].replace(/^\/+/,''); // remove leading slash
      const rawImg = `https://raw.githubusercontent.com/${GH_OWNER}/${GH_REPO}/${GH_REF}/${img}`;
      html.push(`<div style="margin-bottom:8px;"><img src="${rawImg}" alt="${escapeHtml(post.title)}" style="width:100%;height:auto;border-radius:8px;object-fit:cover;" loading="lazy"></div>`);
    }
    // excerpt: first 220 chars of rendered markdown (strip tags)
    const rendered = marked.parse(post.body || '');
    const tmp = document.createElement('div');
    tmp.innerHTML = rendered;
    const excerpt = tmp.textContent.trim().slice(0,360);
    html.push(`<div class="post-excerpt" style="color:var(--text);line-height:1.45;">${escapeHtml(excerpt)}${tmp.textContent.trim().length > excerpt.length ? '‚Ä¶' : ''}</div>`);
    html.push(`<div style="text-align:right;margin-top:8px;"><button class="btn btn-primary read-toggle">Czytaj wiƒôcej</button></div>`);
    html.push(`<div class="post-full" style="display:none;margin-top:12px;border-top:1px dashed rgba(0,0,0,0.04);padding-top:12px;">${rendered}</div>`);
    html.push(`</article>`);
    return html.join('');
  }

  function escapeHtml(s){
    return (''+s).replace(/[&<>'"]/g, function(c){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]; });
  }

  async function loadPosts(lang){
    const container = document.getElementById('updates-list');
    const loadMoreBtn = document.getElementById('load-more');
    container.innerHTML = `<p class="small">≈Åadowanie aktualizacji (${lang})‚Ä¶</p>`;
    _visibleCount = 5;
    try {
      const posts = await fetchPostsList();
      const filtered = posts.filter(p=> (p.lang||'pl') === (lang||'pl'));
      if(filtered.length === 0){
        container.innerHTML = `<p class="small">Brak aktualizacji w jƒôzyku ${lang.toUpperCase()}.</p>`;
        loadMoreBtn.style.display = 'none';
        return;
      }
      // show first _visibleCount
      function renderSlice(count){
        const slice = filtered.slice(0, count);
        container.innerHTML = slice.map(p=>renderPostHTML(p)).join('');
        // attach read toggles
        container.querySelectorAll('.read-toggle').forEach((btn,i)=>{
          btn.onclick = ()=>{
            const full = container.querySelectorAll('.post-full')[i];
            if(!full) return;
            const open = full.style.display !== 'none';
            full.style.display = open ? 'none' : 'block';
            btn.textContent = open ? (dictForLang(lang).read_less || 'Czytaj wiƒôcej') : (dictForLang(lang).read_less || 'Zwi≈Ñ');
            // improve button label minimal: but translations for read_more/read_less not in i18n; keep simple
            btn.textContent = open ? 'Czytaj wiƒôcej' : 'Zwi≈Ñ';
          };
        });
        // show load more?
        if(filtered.length > count){
          loadMoreBtn.style.display = 'inline-block';
        } else {
          loadMoreBtn.style.display = 'none';
        }
      }
      renderSlice(_visibleCount);

      loadMoreBtn.onclick = ()=>{
        _visibleCount += 5;
        renderSlice(_visibleCount);
      };

    } catch(err){
      console.error(err);
      container.innerHTML = `<p class="small">Nie uda≈Ço siƒô pobraƒá aktualizacji z GitHub. Mo≈ºliwe limity API lub brak publicznego repo. (<span style="color:#b91c1c">sprawd≈∫ w konsoli</span>)</p>`;
      document.getElementById('load-more').style.display='none';
    }
  }

  function dictForLang(l){
    // minimal dictionary for read/less if needed later
    return {read_more: (l==='en'?'Read more':'Czytaj wiƒôcej'), read_less: (l==='en'?'Show less':'Zwi≈Ñ')};
  }

  // fetch posts on page load already called inside applyLanguage
  // refresh-posts button
  document.getElementById('refresh-posts').addEventListener('click', ()=>{
    _postsCache = null;
    const lang = localStorage.getItem('educraft_lang') || document.documentElement.lang || 'pl';
    loadPosts(lang);
  });

  // language filter buttons inside updates section
  document.querySelectorAll('.filter-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const lang = btn.dataset.filter;
      applyLanguage(lang);
      // also scroll to updates
      const el = document.getElementById('updates-frame');
      if(el){ el.scrollIntoView({behavior:'smooth', block:'start'}); }
    });
  });

  // minimal smooth scroll for topbar links (preserve offset for fixed topbar)
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click', function(e){
      const href = this.getAttribute('href');
      if(!href || href === "#") return;
      const target = document.querySelector(href);
      if(!target) return;
      e.preventDefault();
      const headerOffset = document.querySelector('.topbar') ? document.querySelector('.topbar').offsetHeight : 72;
      const rect = target.getBoundingClientRect();
      const offsetTop = window.pageYOffset + rect.top - headerOffset - 12;
      window.scrollTo({ top: offsetTop, behavior: 'smooth' });
    });
  });

  // dynamic FAQ build (same as before)
  function buildFAQFor(lang){
    const dict = TRANSLATIONS[lang] || TRANSLATIONS['pl'];
    const faq = document.getElementById('faq');
    if(faq && dict){
      faq.querySelectorAll('details').forEach(d=>d.remove());
      for(let i=1;i<=8;i++){
        const qKey = 'faq_q'+i;
        const aKey = 'faq_a'+i;
        if(dict[qKey] && dict[aKey]){
          const details = document.createElement('details');
          const summary = document.createElement('summary');
          summary.textContent = dict[qKey];
          const p = document.createElement('p');
          p.textContent = dict[aKey];
          details.appendChild(summary);
          details.appendChild(p);
          faq.appendChild(details);
        }
      }
    }
  }

  // Hook into applyLanguage to rebuild FAQ too:
  const _oldApply = applyLanguage;
  applyLanguage = function(lang){
    // call original behavior (we captured earlier)
    (function(prev){
      prev(lang);
    })(_oldApply);
    buildFAQFor(lang);
  };

  // initial build called earlier by initLang -> applyLanguage -> loadPosts
  </script>
</body>
</html>
